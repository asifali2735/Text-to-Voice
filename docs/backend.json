{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the Jannu Connect application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user.",
          "format": "uuid"
        },
        "username": {
          "type": "string",
          "description": "The username of the user."
        },
        "email": {
          "type": "string",
          "description": "The email address of the user.",
          "format": "email"
        },
        "profilePictureUrl": {
          "type": "string",
          "description": "URL to the user's profile picture.",
          "format": "uri"
        },
        "bio": {
          "type": "string",
          "description": "A short biography of the user."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the user account was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "username",
        "email",
        "createdAt"
      ]
    },
    "Post": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Post",
      "type": "object",
      "description": "Represents a post (video or text) in the Jannu Connect application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the post.",
          "format": "uuid"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who created the post. (Relationship: User 1:N Post)"
        },
        "contentUrl": {
          "type": "string",
          "description": "URL to the video or image content of the post.",
          "format": "uri"
        },
        "text": {
          "type": "string",
          "description": "Text description accompanying the post."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the post was created.",
          "format": "date-time"
        },
        "likeCount": {
          "type": "number",
          "description": "The number of likes the post has received."
        },
        "commentCount": {
          "type": "number",
          "description": "The number of comments the post has received."
        }
      },
      "required": [
        "id",
        "userId",
        "contentUrl",
        "createdAt"
      ]
    },
    "Comment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Comment",
      "type": "object",
      "description": "Represents a comment on a post.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the comment.",
          "format": "uuid"
        },
        "postId": {
          "type": "string",
          "description": "Reference to the Post the comment belongs to. (Relationship: Post 1:N Comment)"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who created the comment. (Relationship: User 1:N Comment)"
        },
        "text": {
          "type": "string",
          "description": "The text content of the comment."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the comment was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "postId",
        "userId",
        "text",
        "createdAt"
      ]
    },
    "Follower": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Follower",
      "type": "object",
      "description": "Represents the follower-followee relationship between users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the follower relationship.",
          "format": "uuid"
        },
        "followerId": {
          "type": "string",
          "description": "Reference to the User who is following. (Relationship: User 1:N Follower as Follower)"
        },
        "followeeId": {
          "type": "string",
          "description": "Reference to the User being followed. (Relationship: User 1:N Follower as Followee)"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the follow relationship was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "followerId",
        "followeeId",
        "createdAt"
      ]
    },
    "Like": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Like",
      "type": "object",
      "description": "Represents a like on a post.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the like.",
          "format": "uuid"
        },
        "postId": {
          "type": "string",
          "description": "Reference to the Post that was liked. (Relationship: Post 1:N Like)"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who liked the post. (Relationship: User 1:N Like)"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the like was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "postId",
        "userId",
        "createdAt"
      ]
    },
    "TrendingTopic": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TrendingTopic",
      "type": "object",
      "description": "Represents trending topics and hashtags.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the trending topic.",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "description": "The name of the trending topic or hashtag."
        },
        "postCount": {
          "type": "number",
          "description": "The number of posts associated with this trending topic."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the trending topic was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "postCount",
        "createdAt"
      ]
    },
    "Recommendation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Recommendation",
      "type": "object",
      "description": "Represents content recommendations for users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the recommendation.",
          "format": "uuid"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who is receiving the recommendation. (Relationship: User 1:N Recommendation)"
        },
        "postId": {
          "type": "string",
          "description": "Reference to the Post being recommended. (Relationship: Post 1:N Recommendation)"
        },
        "reason": {
          "type": "string",
          "description": "The reason why this content was recommended (e.g., 'Similar to followed users', 'Based on recent activity')."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the recommendation was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "postId",
        "reason",
        "createdAt"
      ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a push notification sent to a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the notification.",
          "format": "uuid"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who is receiving the notification. (Relationship: User 1:N Notification)"
        },
        "type": {
          "type": "string",
          "description": "The type of notification (e.g., 'new_follower', 'like', 'comment')."
        },
        "content": {
          "type": "string",
          "description": "The content of the notification message."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the notification was created.",
          "format": "date-time"
        },
        "isRead": {
          "type": "boolean",
          "description": "Indicates whether the notification has been read by the user."
        }
      },
      "required": [
        "id",
        "userId",
        "type",
        "content",
        "createdAt",
        "isRead"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. User can only modify their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/posts/{postId}",
        "definition": {
          "entityName": "Post",
          "schema": {
            "$ref": "#/backend/entities/Post"
          },
          "description": "Stores posts created by a specific user. Only the user can create, update, or delete their own posts.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user who created the post."
            },
            {
              "name": "postId",
              "description": "The unique identifier of the post."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/comments/{commentId}",
        "definition": {
          "entityName": "Comment",
          "schema": {
            "$ref": "#/backend/entities/Comment"
          },
          "description": "Stores comments created by a specific user. Only the user can create, update, or delete their own comments.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user who created the comment."
            },
            {
              "name": "commentId",
              "description": "The unique identifier of the comment."
            }
          ]
        }
      },
      {
        "path": "/followers/{followerId}_{followeeId}",
        "definition": {
          "entityName": "Follower",
          "schema": {
            "$ref": "#/backend/entities/Follower"
          },
          "description": "Stores follower-followee relationships. The document ID is a composite key of 'followerId_followeeId'.",
          "params": [
            {
              "name": "followerId",
              "description": "The unique identifier of the user who is following."
            },
            {
              "name": "followeeId",
              "description": "The unique identifier of the user being followed."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/recommendations/{recommendationId}",
        "definition": {
          "entityName": "Recommendation",
          "schema": {
            "$ref": "#/backend/entities/Recommendation"
          },
          "description": "Stores content recommendations for a specific user.  Only the system can create these.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user receiving the recommendation."
            },
            {
              "name": "recommendationId",
              "description": "The unique identifier of the recommendation."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/notifications/{notificationId}",
        "definition": {
          "entityName": "Notification",
          "schema": {
            "$ref": "#/backend/entities/Notification"
          },
          "description": "Stores notifications for a specific user. Only the system can create these, and only the user can mark them as read.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user receiving the notification."
            },
            {
              "name": "notificationId",
              "description": "The unique identifier of the notification."
            }
          ]
        }
      },
      {
        "path": "/trending_topics/{trendingTopicId}",
        "definition": {
          "entityName": "TrendingTopic",
          "schema": {
            "$ref": "#/backend/entities/TrendingTopic"
          },
          "description": "Stores trending topics and hashtags.  System managed.",
          "params": [
            {
              "name": "trendingTopicId",
              "description": "The unique identifier of the trending topic."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "adminRole",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Documents in this collection indicate admin roles. The existence of a document for a userId grants admin privileges.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support the Jannu Connect application's core features, including user profiles, posts, comments, social interactions (following), trending topics, content recommendations, and notifications. The structure prioritizes authorization independence and efficient data retrieval. \n\n**Authorization Independence & DBAC:** User roles are managed through path-based ownership.  Specifically user-owned data such as posts, comments, recommendations, and notifications live under `/users/{userId}`. Following is maintained in the `/followers` collection. A user is implicitly an admin by the existence of a document under `/roles_admin/{userId}`.\n\n**Structural Segregation:** User-generated content (posts and comments) are separated based on ownership into `/users/{userId}/posts` and `/users/{userId}/comments`. Recommendations are stored in `/users/{userId}/recommendations`. Notifications are stored in `/users/{userId}/notifications`. This approach simplifies security rules by ensuring all documents within a collection share the same access control requirements.\n\n**Access Modeling:**\n*   **Private User Data:** User profiles are stored in `/users/{userId}`, ensuring only the user can modify their profile.\n*   **User-Owned Content:** Posts, comments, recommendations, and notifications are stored as subcollections under `/users/{userId}`, adhering to path-based ownership. This simplifies security rules and ensures only the user can manage their content.\n*   **Collaborative Data:** The follower-followee relationship is managed in the `/followers` collection which centralizes the security rules for followers.\n*   **Global Roles (DBAC):** Admin roles are determined by the existence of a document in `/roles_admin/{userId}`. This simplifies admin role management.\n\n**QAPs Support:**\n*   `list` operations are secured by path-based ownership. For example, listing posts for a specific user is done via `/users/{userId}/posts`. The rule will check that `request.auth.uid == userId`.\n*   The `/followers` collection supports listing followers and followees."
  }
}